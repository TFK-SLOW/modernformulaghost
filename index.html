<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Modern Formula Ghost</title>
  <link rel="stylesheet" href="style.css" />
  
</head>
<body>
  <!-- Background Video -->
  <video id="bg-video" autoplay muted loop></video>   

  <!-- Navbar -->
<header class="navbar">
  <div class="logo">
    <img src="photos/mainlogo.svg" alt="Modern Formula Ghost Logo" />
  </div>

  <!-- Nav links -->
  <nav class="nav-links" id="nav-links">
    <a href="#" onclick="openModal()">Upload</a>
    <a href="#home">Home</a>
    <a href="#about">About</a>
    <a href="Player-info/player_info.html">Player Info</a>
    <a href="MFG FORM/form.html">Form</a>
  </nav>

  <!-- Hamburger icon for mobile -->
  <div class="hamburger" id="hamburger">‚ò∞</div>
</header>

  <!-- Content Wrapper -->
  <div class="content">
    <!-- Home Section -->
    <section id="home" class="section home-section">
      <h1>Welcome to Modern Formula Ghost</h1>
      <p>The top 1 drifting club in Car Parking Multiplayer.</p>
    </section>


    <!-- Firebase SDKs from CDN -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

<!-- Uploadcare -->
<script>
  UPLOADCARE_PUBLIC_KEY = 'bd1981046dd0c1b333e4';
</script>
<script src="https://ucarecdn.com/libs/widget/3.x/uploadcare.full.min.js"></script>

<!-- Upload Form -->
<div id="upload-form">
  <input type="text" id="name" placeholder="Your name" />
  <input type="text" id="caption" placeholder="Caption..." />
  <input type="hidden" role="uploadcare-uploader" data-images-only />
  <button onclick="submitPost()">Post</button>
</div>

<!-- Feed Display -->
<div class="feed-grid" id="feed"></div>

<script>
  // ‚úÖ Your Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyDKjvERjZEGVOkcBtlduUZFA6kRk6k-B18",
    authDomain: "modern-formula-ghost.firebaseapp.com",
    projectId: "modern-formula-ghost",
    storageBucket: "modern-formula-ghost.firebasestorage.app",
    messagingSenderId: "456424596100",
    appId: "1:456424596100:web:556a3eeb39d8329aca98d1",
    measurementId: "G-JHDBDZ1YZ6"
  };

  // Init Firebase App
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // Uploadcare widget
  const widget = uploadcare.Widget('[role=uploadcare-uploader]');
  let uploadedImageUrl = "";

  widget.onUploadComplete((info) => {
    uploadedImageUrl = info.cdnUrl;
  });

  // Submit new post to Firestore
  function submitPost() {
    const name = document.getElementById("name").value.trim();
    const caption = document.getElementById("caption").value.trim();

    if (!uploadedImageUrl || !name || !caption) {
      alert("Please complete all fields and upload an image.");
      return;
    }

    db.collection("posts").add({
      name: name,
      caption: caption,
      image: uploadedImageUrl,
      createdAt: new Date()
    }).then(() => {
      alert("Post added!");
      location.reload();
    });
  }

  function deletePost(id) {
  if (confirm("Are you sure you want to delete this post?")) {
    db.collection("posts").doc(id).delete().then(() => {
      alert("Post deleted.");
      location.reload();
    }).catch((error) => {
      console.error("Error deleting post: ", error);
    });
  }
}

  // Load all posts
  function loadFeed() {
    const feed = document.getElementById("feed");
    db.collection("posts").orderBy("createdAt", "desc").get().then(snapshot => {
      snapshot.forEach(doc => {
        const data = doc.data();
        const postId = doc.id;
  
        const post = document.createElement("div");
        post.className = "feed-post";
        post.innerHTML = `
          <img src="${data.image}" alt="Drift photo" />
          <p><strong>${data.name}</strong>: ${data.caption}</p>
          <button class="delete-btn" onclick="deletePost('${postId}')">üóëÔ∏è Delete</button>
        `;
        feed.appendChild(post);
      });
    });
  }

  loadFeed();
</script>
    

    <!-- About Section -->
    <section id="about" class="section about-split">
      <div class="about-left">
        <img src="photos/mfglogo.svg" alt="Club Image" />
      </div>
      <div class="about-right">
        <h2>About the Club</h2>
        <p>
          Modern Formula Ghost is a competitive drifting team in Car Parking Multiplayer.
          We focus on precision, style, and teamwork. Whether it's tandem drifting or
          showcasing your ride, our club lives for the thrill of controlled chaos.
        </p>
      </div>
    </section>
  </div>

  <!-- Upload Modal -->
<div id="uploadModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">&times;</span>
    <h2>Upload Post</h2>
    <input type="text" id="name" placeholder="Your name" />
    <input type="text" id="caption" placeholder="Caption..." />
    <input type="hidden" role="uploadcare-uploader" data-images-only />
    <button onclick="submitPost()">Post</button>
  </div>
</div>

  <footer>
  <p id="tiktok">Contact us:<br><a href="https://www.tiktok.com/@mfgteam?is_from_webapp=1&sender_device=pc" target="_blank">TIKTOK</a><br><a href="https://www.facebook.com/profile.php?id=61577144714826" target="_blank">FACEBOOK</a></p>
  <p>¬© 2025 Modern Formula Ghost Team. All rights reserved.</p>
  <p><span class="powered-by">THIS WEBSITE IS MADE BY SLOW AND THIS WEBSITE BE ONLY USED FOR MODERN FORMULA GHOST CLUB</span></p>
</footer>

<script>
  const videoElement = document.getElementById('bg-video');
  const videoSources = [
    'videos/RX7_film.mp4',
    'videos/mountain meet.mp4',
    'videos/repair.mp4'
  ];

  let currentIndex = 0;

  function playNext() {
    videoElement.src = videoSources[currentIndex];
    videoElement.load();
    videoElement.play();

    // Set up next index (looping back to 0 at the end)
    currentIndex = (currentIndex + 1) % videoSources.length;

    // Set up next video when this one ends
    videoElement.onended = playNext;
  }

  playNext();

  const hamburger = document.getElementById("hamburger");
  const navLinks = document.getElementById("nav-links");

  hamburger.addEventListener("click", () => {
    navLinks.classList.toggle("open");
  });

    uploadcare.Widget('[role=uploadcare-uploader]').onUploadComplete(function(info) {
    const feedGrid = document.querySelector('.feed-grid');

    // Create a new post element
    const newPost = document.createElement('div');
    newPost.classList.add('feed-post');

    newPost.innerHTML = `
      <img src="${info.cdnUrl}" alt="Uploaded by user">
      <p><strong>User:</strong> New upload!</p>
    `;

    // Add to top of feed
    feedGrid.prepend(newPost);
  });

    function openModal() {
    document.getElementById("uploadModal").style.display = "block";
  }

  function closeModal() {
    document.getElementById("uploadModal").style.display = "none";
  }

  // Close modal if user clicks outside the box
  window.onclick = function (event) {
    const modal = document.getElementById("uploadModal");
    if (event.target === modal) {
      modal.style.display = "none";
    }
  };
</script>
</body>
</html>
